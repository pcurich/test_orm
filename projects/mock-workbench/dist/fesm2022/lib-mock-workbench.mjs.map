{"version":3,"file":"lib-mock-workbench.mjs","sources":["../../src/lib/ensure-services.ts","../../src/lib/mock-workbench.component.ts","../../src/lib/mount.ts","../../src/lib/http-mock-client.ts","../../src/lib/service-helper.ts","../../src/lib-mock-workbench.ts"],"sourcesContent":["/**\r\n * Util que crea y cachea los servicios IndexedDB usados por el workbench.\r\n * Exporta `ensureServices()` que devuelve un objeto con los servicios o null.\r\n */\r\n\r\nimport { DBInitOptions } from './types';\r\nlet cachedServices: any | null = null;\r\n\r\nexport async function ensureServices(options: DBInitOptions) {\r\n  window.console.log('ensureServices called with options:', options);\r\n  if (cachedServices) return cachedServices;\r\n  try {\r\n    // dynamic import to keep dev-only package out of prod bundles\r\n    // @ts-ignore\r\n    const lib = await import('@pcurich/client-storage').catch(() => null);\r\n    const createIndexedDbServices = lib?.createIndexedDbServices;\r\n    if (typeof createIndexedDbServices !== 'function') {\r\n      // eslint-disable-next-line no-console\r\n      console.warn('[lib-mock-workbench] createIndexedDbServices not found in @pcurich/client-storage');\r\n      return null;\r\n    }\r\n\r\n    const cfg: DBInitOptions = { dbName: options?.dbName ?? 'myDb', version: options?.version ?? 1, stores: options?.stores ?? [], httpOnly: options?.httpOnly ?? true };\r\n    window.console.log('Creating IndexedDB services with config:', cfg);\r\n    const services = await createIndexedDbServices(cfg);\r\n    cachedServices = services;\r\n    // eslint-disable-next-line no-console\r\n    console.log('[lib-mock-workbench] IndexedDB services created');\r\n    return services;\r\n  } catch (err) {\r\n    // eslint-disable-next-line no-console\r\n    console.error('[lib-mock-workbench] ensureServices failed', err);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function destroyServices() {\r\n  try {\r\n    const s = cachedServices;\r\n    if (!s) return;\r\n    if (typeof s.destroy === 'function') await s.destroy();\r\n    else if (typeof s.close === 'function') await s.close();\r\n  } catch (err) {\r\n    // eslint-disable-next-line no-console\r\n    console.warn('[lib-mock-workbench] destroyServices failed', err);\r\n  } finally {\r\n    cachedServices = null;\r\n  }\r\n}\r\n","import { Component, ElementRef, HostListener, Input, NgZone, OnChanges, OnDestroy, SimpleChanges } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport type { ContextOption, DBInitOptions, StoreConfig } from './types';\r\nimport { ensureServices, destroyServices } from './ensure-services';\r\n\r\n/**\r\n * This Angular wrapper exposes the tag <custom-mock-workbench> and creates/manages\r\n * the actual inner webcomponent <mock-workbench>.\r\n * The library's webcomponent handles the UI; this wrapper forwards inputs and\r\n * listens for events emitted by the webcomponent so consumers can use an Angular API.\r\n */\r\n@Component({\r\n  standalone: true,\r\n  selector: 'custom-mock-workbench',\r\n  imports: [CommonModule],\r\n  template: `\r\n    <div class=\"mock-workbench-host\"></div>\r\n  `\r\n})\r\nexport class MockWorkbenchComponent implements OnChanges, OnDestroy {\r\n  private wcEl: any | null = null;\r\n  @Input() keyMock: string = 'useMock';\r\n  @Input() dbName?: string = 'myDb';\r\n  @Input() version?: number = 1;\r\n  @Input() stores?: StoreConfig[] = [];\r\n  @Input() httpOnly?: boolean = true;\r\n\r\n  @Input() contextOptions?: ContextOption[] = [];\r\n\r\n  public httpMockService: any | null = null;\r\n\r\n  private options!: DBInitOptions;\r\n\r\n  constructor(private hostRef: ElementRef, private ngZone: NgZone) {\r\n\r\n  }\r\n\r\n  public async initDb(): Promise<void> {\r\n    try {\r\n      this.options = { dbName: this.dbName, version: this.version, stores: this.stores, httpOnly: this.httpOnly };\r\n      window.console.log('Initializing IndexedDB services with options:', this.options);\r\n      window.console.log('ensureServices called with options:', this.dbName, this.version, this.stores, this.httpOnly);\r\n      const services = await ensureServices(this.options);\r\n      this.httpMockService = services?.httpMockService ?? this.httpMockService;\r\n\r\n    } catch (e) {\r\n      // eslint-disable-next-line no-console\r\n      console.error('[custom-mock-workbench] Failed to initialize IndexedDB services', e);\r\n    }\r\n  }\r\n\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    // Forward changed inputs to the underlying webcomponent if it's already created\r\n    if (!this.wcEl) return;\r\n    for (const k of Object.keys(changes)) {\r\n      try {\r\n        // map inputs to properties expected by the webcomponent\r\n        (this.wcEl as any)[k] = (this as any)[k];\r\n        console.log(`[custom-mock-workbench] Updated property ${k} on webcomponent to`, (this as any)[k]);\r\n      } catch (_e) {\r\n        // ignore assignment failures\r\n        console.error(`[custom-mock-workbench] Could not update property ${k} on webcomponent`);\r\n      }\r\n    }\r\n  }\r\n\r\n  ngAfterViewInit(): void {\r\n    // Create and attach the webcomponent inside the host element\r\n    // Run outside Angular to avoid triggering change detection from webcomponent internals\r\n    this.ngZone.runOutsideAngular(() => {\r\n      try {\r\n        // Ensure the webcomponent's loader is defined. The loader package\r\n        // `http-mock-workbench` is development-only and should be a dependency of\r\n        // this library. Load it dynamically and call its registration helpers\r\n        // if available. This keeps the main app free of direct references.\r\n        (async () => {\r\n          try {\r\n            // The loader is a dev-only package and may not have typings available\r\n            // to the library build. Suppress TS here because the import is dynamic\r\n            // and only required at runtime in dev environments.\r\n            // @ts-ignore: Dynamic dev-only import\r\n            const mod = await import('@pcurich/http-mock-workbench/loader');\r\n            const modAny = mod as any;\r\n            const apply = (modAny && (modAny.applyPolyfills ?? modAny.default?.applyPolyfills)) as\r\n              | (() => Promise<any>)\r\n              | undefined;\r\n            const define = (modAny && (modAny.defineCustomElements ?? modAny.default?.defineCustomElements)) as\r\n              | ((win: any) => void)\r\n              | undefined;\r\n            if (apply) {\r\n              await apply();\r\n            }\r\n            if (define) {\r\n              define(window);\r\n            }\r\n          } catch (_err) {\r\n            // If the loader isn't available, continue — the component may still\r\n            // work if it's registered elsewhere or not required in this env.\r\n            // eslint-disable-next-line no-console\r\n            console.warn('@pcurich/http-mock-workbench loader not available from library; webcomponent may not be defined.');\r\n          }\r\n        })();\r\n        const hostEl: HTMLElement = this.hostRef.nativeElement.querySelector('.mock-workbench-host') || this.hostRef.nativeElement;\r\n        // We create the original webcomponent (<mock-workbench>) inside this wrapper so\r\n        // consumers can use the wrapper tag <custom-mock-workbench> while the Stencil\r\n        // component remains registered as <mock-workbench> by its loader.\r\n        const el = document.createElement('mock-workbench') as any;\r\n        // append to DOM\r\n        hostEl.appendChild(el);\r\n        this.wcEl = el;\r\n        // Ensure initial inputs are forwarded to the webcomponent (e.g. keyMock)\r\n        try {\r\n          if (this.keyMock != null) (this.wcEl as any).keyMock = this.keyMock;\r\n          if (this.contextOptions != null) (this.wcEl as any).contextOptions = this.contextOptions;\r\n\r\n        } catch (_e) {\r\n          /* ignore */\r\n        }\r\n        console.log('[custom-mock-workbench] <mock-workbench> webcomponent created inside wrapper.');\r\n      } catch (e) {\r\n        // eslint-disable-next-line no-console\r\n        console.warn('Could not create inner <mock-workbench> webcomponent for <custom-mock-workbench> wrapper:', e);\r\n      }\r\n    });\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    try {\r\n      if (this.wcEl && this.wcEl.parentNode) {\r\n        this.wcEl.parentNode.removeChild(this.wcEl);\r\n      }\r\n    } catch (_e) {\r\n      /* noop */\r\n    }\r\n    this.wcEl = null;\r\n    // best-effort destroy of cached services in the util\r\n    try {\r\n      void destroyServices();\r\n    } catch (_e) {\r\n      /* noop */\r\n    }\r\n  }\r\n\r\n  @HostListener('saveMockSchemaEvent', ['$event'])\r\n  async onSaveMockSchemaEvent(evt: any): Promise<void> {\r\n    // eslint-disable-next-line no-console\r\n    const { delayMs, headers, httpCodeResponseValue, httpMethod, nameMock, serviceCode, url } = evt?.detail ?? evt;\r\n\r\n    const services = await ensureServices(this.options);\r\n    const service = services?.httpMockService ?? this.httpMockService;\r\n    if (!service) {\r\n      // eslint-disable-next-line no-console\r\n      console.warn('[custom-mock-workbench] httpMockService not available; cannot save mock schema');\r\n      return;\r\n    }\r\n\r\n    let contextId: any = null;\r\n    try {\r\n      // Try to find existing mocks for the same serviceCode\r\n      let existing: any = null;\r\n      if (typeof service.findByServiceCode === 'function') {\r\n        try {\r\n          existing = await service.findByServiceCode(serviceCode);\r\n        } catch (_e) {\r\n          // ignore find errors and continue to create\r\n          existing = null;\r\n        }\r\n      }\r\n\r\n      const foundList = Array.isArray(existing) ? existing : (existing ? [existing] : []);\r\n      if (foundList.length) {\r\n        // Update the first matching entry\r\n        const original = foundList[0] as any;\r\n        const toUpdate = {\r\n          ...original,\r\n          delayMs,\r\n          headers,\r\n          httpCodeResponseValue,\r\n          httpMethod,\r\n          nameMock,\r\n          serviceCode,\r\n          url\r\n        } as any;\r\n        const updated = await service.updateMock(toUpdate);\r\n        contextId = updated?._id ?? updated?.id ?? updated;\r\n      } else {\r\n        // Create new mock if none found\r\n        const created = await service.createMock({ delayMs, headers, httpCodeResponseValue, httpMethod, nameMock, serviceCode, url } as any);\r\n        contextId = created?._id ?? created?.id ?? created;\r\n      }\r\n    } catch (err) {\r\n      // eslint-disable-next-line no-console\r\n      console.error('[custom-mock-workbench] Error creating/updating mock schema', err);\r\n      return;\r\n    }\r\n    const el = this.wcEl ?? (document.querySelector('mock-workbench') as any);\r\n    if (el) {\r\n      el.contextId = contextId;\r\n      el.activeTab = 1;\r\n    }\r\n    console.log('[custom-mock-workbench] saveMockSchemaEvent', contextId);\r\n  }\r\n\r\n  @HostListener('contextTypeChangeEvent', ['$event'])\r\n  onContextTypeChangeEvent(evt: any): void {\r\n    // eslint-disable-next-line no-console\r\n    const context: ContextOption = (evt?.detail ?? evt) as ContextOption;\r\n    window.localStorage.setItem(this.keyMock, JSON.stringify(context));\r\n    console.log('[custom-mock-workbench] contextTypeChangeEvent', context);\r\n    window.location.reload();\r\n  }\r\n\r\n  @HostListener('loadContextEvent', ['$event'])\r\n  async onLoadContextEventFromWC(evt: any): Promise<void> {\r\n    const id = evt?.detail ?? evt;\r\n    try {\r\n      // Prefer existing cached services; ensureServices handles dynamic import and caching.\r\n      const services = await ensureServices(this.options);\r\n      const service = services?.httpMockService ?? this.httpMockService;\r\n      if (!service) {\r\n        // eslint-disable-next-line no-console\r\n        console.warn('[custom-mock-workbench] httpMockService not available; cannot load mock');\r\n        return;\r\n      }\r\n\r\n      const mock = await service.getMockById(id);\r\n      // eslint-disable-next-line no-console\r\n      console.log('[custom-mock-workbench] Loaded mock from webcomponent event:', mock);\r\n\r\n      const el = this.wcEl ?? (document.querySelector('mock-workbench') as any);\r\n      if (!el || !mock) return;\r\n\r\n      // Map fields with safe fallbacks for different fixture shapes\r\n      try { el.contextId = mock._id ?? mock.id; } catch { }\r\n      try { el.nameMock = mock.nameMock ?? mock.name; } catch { }\r\n      try { el.serviceCode = mock.serviceCode ?? mock.service; } catch { }\r\n      try { el.url = mock.url ?? mock.path ?? mock.endpoint; } catch { }\r\n      try { el.httpMethod = mock.httpMethod ?? mock.method; } catch { }\r\n      try { el.httpCodeResponseValue = Number(mock.httpCodeResponseValue ?? mock.responseCode ?? mock.responseCodeValue ?? 0); } catch { }\r\n      try { el.delayMs = Number(mock.delayMs ?? mock.delay ?? 0); } catch { }\r\n      if (mock.headers) try { el.headers = mock.headers; } catch { }\r\n      if (mock.responseBody) try { el.responseBody = mock.responseBody; } catch { }\r\n      try { el.activeTab = 2; } catch { }\r\n\r\n    } catch (err) {\r\n      // eslint-disable-next-line no-console\r\n      console.error('[custom-mock-workbench] Error loading mock for id', id, err);\r\n    }\r\n  }\r\n\r\n  @HostListener('deleteContextEvent', ['$event'])\r\n  async onDeleteContextEventFromWC(evt: any): Promise<void> {\r\n    const id = evt?.detail ?? evt;\r\n    try {\r\n      const services = await ensureServices(this.options);\r\n      const service = services?.httpMockService ?? this.httpMockService;\r\n      if (!service) {\r\n        // eslint-disable-next-line no-console\r\n        console.warn('[custom-mock-workbench] httpMockService not available; cannot delete mock');\r\n        return;\r\n      }\r\n\r\n      await service.deleteMock(id);\r\n\r\n      const el = this.wcEl ?? (document.querySelector('mock-workbench') as any);\r\n      // If the deleted mock is currently loaded in the webcomponent, clear its state\r\n      if (el && (el.contextId === id || el.contextId === (id as any)?._id)) {\r\n        try { el.contextId = 0; } catch { }\r\n        try { el.nameMock = ''; } catch { }\r\n        try { el.serviceCode = ''; } catch { }\r\n        try { el.url = ''; } catch { }\r\n        try { el.httpMethod = 'GET'; } catch { }\r\n        try { el.httpCodeResponseValue = 200; } catch { }\r\n        try { el.delayMs = 0; } catch { }\r\n        try { el.headers = {}; } catch { }\r\n        try { el.responseBody = '{}'; } catch { }\r\n        try { el.activeTab = 2; } catch { }\r\n      }\r\n\r\n      // eslint-disable-next-line no-console\r\n      console.log('[custom-mock-workbench] deleteContextEvent deleted id', id);\r\n    } catch (err) {\r\n      // eslint-disable-next-line no-console\r\n      console.error('[custom-mock-workbench] Error deleting mock for id', id, err);\r\n    }\r\n  }\r\n\r\n  @HostListener('saveHeadersEvent', ['$event'])\r\n  async onSaveHeadersEvent(evt: any): Promise<void> {\r\n    // eslint-disable-next-line no-console\r\n    let headers: Record<string, string> = evt?.detail ?? evt;\r\n    try {\r\n      const services = await ensureServices(this.options);\r\n      const service = services?.httpMockService ?? this.httpMockService;\r\n      if (!service) {\r\n        // eslint-disable-next-line no-console\r\n        console.warn('[custom-mock-workbench] httpMockService not available; cannot save headers');\r\n        return;\r\n      }\r\n\r\n      const el = this.wcEl ?? (document.querySelector('mock-workbench') as any);\r\n      const mock = el ? await service.getMockById(el.contextId) : null;\r\n      if (mock) {\r\n        mock.headers = headers;\r\n        await service.updateMock(mock);\r\n      }\r\n    } catch (err) {\r\n      // eslint-disable-next-line no-console\r\n      console.error('[custom-mock-workbench] Error saving headers', evt?.detail ?? evt, err);\r\n    }\r\n    console.log('[custom-mock-workbench] saveHeadersEvent', evt?.detail ?? evt);\r\n  }\r\n\r\n  @HostListener('saveMockBodyEvent', ['$event'])\r\n  async onSaveMockBodyEvent(evt: any): Promise<void> {\r\n    // eslint-disable-next-line no-console\r\n    let response = evt?.detail ?? evt;\r\n    try {\r\n      const services = await ensureServices(this.options);\r\n      const service = services?.httpMockService ?? this.httpMockService;\r\n      if (!service) {\r\n        // eslint-disable-next-line no-console\r\n        console.warn('[custom-mock-workbench] httpMockService not available; cannot save mock body');\r\n        return;\r\n      }\r\n\r\n      const el = this.wcEl ?? (document.querySelector('mock-workbench') as any);\r\n      const mock = el ? await service.getMockById(el.contextId) : null;\r\n\r\n      // eslint-disable-next-line no-console\r\n      console.log('contextId in saveMockBodyEvent:', el?.contextId, 'current mock:', mock);\r\n\r\n      if (mock) {\r\n        // Update responseBody and persist\r\n        mock.responseBody = response.responseBody;\r\n        await service.updateMock(mock);\r\n      }\r\n    } catch (err) {\r\n      // eslint-disable-next-line no-console\r\n      console.error('[custom-mock-workbench] Error saving mock body', evt?.detail ?? evt, err);\r\n    }\r\n    console.log('[custom-mock-workbench] saveMockBodyEvent', evt?.detail ?? evt);\r\n  }\r\n\r\n  @HostListener('reloadEvent', ['$event'])\r\n  onReloadEvent(evt: any): void {\r\n    // eslint-disable-next-line no-console\r\n    window.location.reload()\r\n    console.log('[custom-mock-workbench] reloadEvent', evt?.detail ?? evt);\r\n  }\r\n\r\n  async insertSample(): Promise<void> {\r\n    try {\r\n      const services = await ensureServices(this.options);\r\n      const service = services?.httpMockService ?? this.httpMockService;\r\n      if (!service) throw new Error('httpMockService not available');\r\n\r\n      const fixture = {\r\n        url: '/api/sample',\r\n        method: 'GET',\r\n        responseCode: 200,\r\n        responseBody: { message: 'Sample mock response' },\r\n        delay: 1000\r\n      };\r\n\r\n      await service.createMock(fixture as any);\r\n\r\n    } catch (e) {\r\n      // eslint-disable-next-line no-console\r\n      console.error('[custom-mock-workbench] Error insertando mock de ejemplo', e);\r\n    }\r\n  }\r\n\r\n  async listMocks(): Promise<void> {\r\n    try {\r\n      const services = await ensureServices(this.options);\r\n      const service = services?.httpMockService ?? this.httpMockService;\r\n      if (!service) throw new Error('httpMockService not available');\r\n\r\n      const all = await service.getAllMocks();\r\n      // eslint-disable-next-line no-console\r\n      console.log('[custom-mock-workbench] Mocks registrados:', all);\r\n    } catch (e) {\r\n      // eslint-disable-next-line no-console\r\n      console.error('[custom-mock-workbench] Error listando mocks', e);\r\n    }\r\n  }\r\n}\r\n","import { ViewContainerRef, ComponentRef } from '@angular/core';\r\nimport { MockWorkbenchComponent } from './mock-workbench.component';\r\nimport { MountProps, MountResult } from './types';\r\n\r\n/**\r\n * Helper to mount the MockWorkbenchComponent into a host ViewContainerRef.\r\n * Returns a small controller with the created ComponentRef and a destroy helper.\r\n */\r\nexport function mountMockWorkbench(host: ViewContainerRef, props?: MountProps): MountResult {\r\n  const ref = host.createComponent(MockWorkbenchComponent as any) as ComponentRef<MockWorkbenchComponent>;\r\n\r\n  if (props && typeof props === 'object') {\r\n    // Assign props defensively: only copy known keys to avoid unexpected writes\r\n    // include `keyMock` so callers can pass the storage key used by the wrapper\r\n    debugger;\r\n    const allowedDB = ['nameMock', 'serviceCode', 'url', 'httpMethod', 'httpCodeResponseValue', 'delayMs', 'keyMock', 'dbName', 'version', 'stores', 'httpOnly'];\r\n    const allowedComponent = ['contextOptions'];\r\n    for (const k of Object.keys(props)) {\r\n      if (!allowedDB.includes(k)) continue;\r\n      try {\r\n        // Special handling for `stores` to ensure the array items are normalized and typed\r\n        if (k === 'stores') {\r\n          const stores = (props as any).stores;\r\n          if (Array.isArray(stores)) {\r\n            const normalized = stores.map((s: any) => ({\r\n              name: String(s?.name ?? ''),\r\n              keyPath: s?.keyPath === undefined ? undefined : s.keyPath,\r\n              autoIncrement: typeof s?.autoIncrement === 'boolean' ? s.autoIncrement : Boolean(s?.autoIncrement),\r\n              indexes: Array.isArray(s?.indexes)\r\n                ? s.indexes.map((idx: any) => ({\r\n                    name: String(idx?.name ?? ''),\r\n                    keyPath: idx?.keyPath,\r\n                    options: idx?.options && typeof idx.options === 'object' ? idx.options : undefined,\r\n                  }))\r\n                : undefined,\r\n            }));\r\n            (ref.instance as any)[k] = normalized;\r\n          }\r\n        } else {\r\n          (ref.instance as any)[k] = (props as any)[k];\r\n        }\r\n      } catch (_e) {\r\n        // ignore individual assignment failures\r\n      }\r\n    };\r\n    for (const k of Object.keys(props)) {\r\n      if (!allowedComponent.includes(k)) continue;\r\n      try {\r\n        // Special handling for `contextOptions` to ensure correct shape\r\n        if (k === 'contextOptions') {\r\n          const ctx = (props as any).contextOptions;\r\n          if (Array.isArray(ctx)) {\r\n            const normalized = ctx.map((c: any) => ({\r\n              id: c?.id,\r\n              value: c?.value === undefined ? undefined : String(c?.value),\r\n              useMock: typeof c?.useMock === 'boolean' ? c.useMock : Boolean(c?.useMock),\r\n            }));\r\n            (ref.instance as any)[k] = normalized;\r\n          }\r\n        } else {\r\n          (ref.instance as any)[k] = (props as any)[k];\r\n        }\r\n      } catch (_e) {\r\n        // ignore individual assignment failures\r\n      }\r\n    }\r\n\r\n    ref.instance.initDb?.();\r\n  }\r\n\r\n  return {\r\n    ref,\r\n    destroy: () => {\r\n      try {\r\n        ref.destroy();\r\n      } catch (_e) {\r\n        // ignore\r\n      }\r\n      try {\r\n        // clear the host if possible (best-effort)\r\n        if (host.length && typeof host.clear === 'function') {\r\n          host.clear();\r\n        }\r\n      } catch (_e) {\r\n        // ignore\r\n      }\r\n    }\r\n  };\r\n}\r\n","import type { DBInitOptions, HttpMockEntity } from './types';\r\nimport { ensureServices as ensureSharedServices } from './ensure-services';\r\n\r\nlet cachedHttpMockService: any | null = null;\r\n\r\nasync function ensureService(options: DBInitOptions): Promise<any | null> {\r\n  if (cachedHttpMockService) return cachedHttpMockService;\r\n  const s = await ensureSharedServices(options);\r\n  cachedHttpMockService = s?.httpMockService ?? null;\r\n  return cachedHttpMockService;\r\n}\r\n\r\nexport const httpMockClient = {\r\n  options: {} as DBInitOptions,\r\n\r\n  async setDbOptions(options: DBInitOptions): Promise<void> {\r\n    this.options = options;\r\n  },\r\n\r\n  async createMock(data: Partial<HttpMockEntity>): Promise<HttpMockEntity> {\r\n    const svc = await ensureService(this.options);\r\n    if (!svc) throw new Error('httpMockService not available');\r\n    const created = await svc.createMock(data as any);\r\n    return created as HttpMockEntity;\r\n  },\r\n\r\n  async getMockById(id: IDBValidKey): Promise<HttpMockEntity | null> {\r\n    const svc = await ensureService(this.options);\r\n    if (!svc) throw new Error('httpMockService not available');\r\n    const res = await svc.getMockById(id);\r\n    return (res as HttpMockEntity) ?? null;\r\n  },\r\n\r\n  async updateMock(entity: HttpMockEntity): Promise<HttpMockEntity> {\r\n    const svc = await ensureService(this.options);\r\n    if (!svc) throw new Error('httpMockService not available');\r\n    const updated = await svc.updateMock(entity as any);\r\n    return updated as HttpMockEntity;\r\n  },\r\n\r\n  async deleteMock(id: IDBValidKey): Promise<boolean> {\r\n    const svc = await ensureService(this.options);\r\n    if (!svc) throw new Error('httpMockService not available');\r\n    const ok = await svc.deleteMock(id);\r\n    return Boolean(ok);\r\n  },\r\n\r\n  async getAllMocks(): Promise<HttpMockEntity[]> {\r\n    const svc = await ensureService(this.options);\r\n    if (!svc) throw new Error('httpMockService not available');\r\n    const all = await svc.getAllMocks();\r\n    return (all as HttpMockEntity[]) ?? [];\r\n  },\r\n  async findByUrl(url: string, indexName = 'url', expectedKeyPath: string | string[] = 'url'): Promise<HttpMockEntity[]> {\r\n    const svc = await ensureService(this.options);\r\n    if (!svc) throw new Error('httpMockService not available');\r\n    // Try service-provided index search\r\n    if (typeof svc.findByIndex === 'function') {\r\n      try {\r\n        return await svc.findByIndex(url, indexName, expectedKeyPath);\r\n      } catch (_e) {\r\n        // fallback\r\n      }\r\n    }\r\n    // fallback: scan all\r\n    const all = await svc.getAllMocks();\r\n    return (all as HttpMockEntity[]).filter(m => String(m.url) === String(url));\r\n  },\r\n  async findByServiceCode(serviceCode: string, indexName = 'serviceCode', expectedKeyPath: string | string[] = 'serviceCode'): Promise<HttpMockEntity[]> {\r\n    const svc = await ensureService(this.options);\r\n    if (!svc) throw new Error('httpMockService not available');\r\n    if (typeof svc.findByIndex === 'function') {\r\n      try {\r\n        return await svc.findByIndex(serviceCode, indexName, expectedKeyPath);\r\n      } catch (_e) {\r\n        // fallback\r\n      }\r\n    }\r\n    const all = await svc.getAllMocks();\r\n    return (all as HttpMockEntity[]).filter(m => String(m.serviceCode) === String(serviceCode));\r\n  },\r\n  async findByIndex(value: IDBValidKey | IDBKeyRange, indexName = 'by_url', expectedKeyPath?: string | string[]): Promise<HttpMockEntity[]> {\r\n    const svc = await ensureService(this.options);\r\n    if (!svc) throw new Error('httpMockService not available');\r\n    if (typeof svc.findByIndex === 'function') {\r\n      return await svc.findByIndex(value, indexName, expectedKeyPath);\r\n    }\r\n    // fallback: naive scan\r\n    const all = await svc.getAllMocks();\r\n    return (all as HttpMockEntity[]).filter(m => {\r\n      const candidate = expectedKeyPath ? (Array.isArray(expectedKeyPath) ? expectedKeyPath.map(k => (m as any)[k]).join('|') : (m as any)[expectedKeyPath]) : m.url;\r\n      return candidate === value;\r\n    });\r\n  },\r\n\r\n  async getResponseBodyAs<T>(id: IDBValidKey): Promise<T | null> {\r\n    const mock = await this.getMockById(id);\r\n    if (!mock) return null;\r\n    return (mock.responseBody ?? null) as T | null;\r\n  }\r\n};\r\n","/**\r\n * Helper para recuperar el mock asociado a un `serviceCode` desde la librería\r\n * Esta función encapsula la import dinámica de `httpMockClient`, la búsqueda\r\n * por `serviceCode` y el parseo del `responseBody` en un formato usable.\r\n */\r\nimport type { HttpMockEntity, DBInitOptions } from './types';\r\nimport { ensureServices } from './ensure-services';\r\n\r\nexport interface ServiceMockResult<T = any> {\r\n  data: T[];\r\n  httpCodeResponseValue: number;\r\n  httpMethod: string;\r\n  delayMs: number;\r\n  source?: HttpMockEntity | null;\r\n}\r\n\r\n\r\n/**\r\n * Busca mocks por serviceCode y devuelve el primer body válido parseado.\r\n * Intent: usar await import('lib-mock-workbench') en tiempo de ejecución y\r\n * preferir la ruta de `ensureServices()` cuando esté disponible.\r\n */\r\n/**\r\n * Busca mocks por serviceCode y devuelve la lista de entidades encontradas.\r\n * No intenta parsear ni iterar los bodies: esa responsabilidad queda para el\r\n * consumidor. Retorna `HttpMockEntity[]` o `null` si no se pudieron obtener.\r\n */\r\n/**\r\n * Busca mocks por `serviceCode` y devuelve la lista de entidades encontradas.\r\n * Acepta un parámetro opcional `options` de tipo `DBInitOptions` que será\r\n * pasado a `ensureServices(options)` para inicializar/abrir la DB con la\r\n * configuración suministrada (dbName, version, stores, etc.).\r\n */\r\nexport async function fetchMockByServiceCode(serviceCode: string, options?: DBInitOptions): Promise<HttpMockEntity[]> {\r\n  try {\r\n  // ensureServices expects a DBInitOptions object (not undefined), so provide\r\n  // an empty object when options is not supplied.\r\n  const services = await ensureServices((options ?? {}) as DBInitOptions);\r\n    const service = services?.httpMockService;\r\n\r\n    let client: any | undefined = undefined;\r\n    // si el servicio expone client directamente úsalo; de lo contrario busca propiedades\r\n    client = service?.httpMockClient ?? service?.httpMockService ?? service;\r\n    if (!client) return [];\r\n\r\n    const found = typeof client.findByServiceCode === 'function'\r\n      ? await client.findByServiceCode(serviceCode)\r\n      : (typeof client.find === 'function' ? await client.find({ serviceCode }) : null);\r\n\r\n    const list: HttpMockEntity[] = Array.isArray(found) ? found : (found ? [found] : []);\r\n    return list.length ? list : [];\r\n  } catch (err) {\r\n    // eslint-disable-next-line no-console\r\n    console.error('[mock-workbench] fetchMockByServiceCode error', err);\r\n    return [];\r\n  }\r\n}\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":["ensureSharedServices"],"mappings":"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"}